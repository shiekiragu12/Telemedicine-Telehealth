{% extends 'base.html' %}
{% load static %}
{% block title %} Get In Touch {% endblock title %}
{% block content %}

<!-- Start Page Title Area -->
<div class="page-title-area" style="background-image: url(/static/assets/img/page-title/bg.webp);">
    <div class="d-table" style="background: rgba(0, 0, 0, 0.7);">
        <div class="d-table-cell">
            <div class="container">
                <div class="page-title-content">
                    <h2>Contact Us</h2>
                    <ul>
                        <li><a href="{% url 'index' %}">Home</a></li>
                        <li>Contact Us</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- End Page Title Area -->

<!-- Service details -->
<!-- Start Contact Area -->
<section class="contact-area ptb-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="contact-info-box">
                    <div class="icon">
                        <i class='flaticon-email'></i>
                    </div>

                    <h3>Email Here</h3>
                    <p><a href="mailto:info@resq247.life">info@resq247.life </a></p>
                </div>
            </div>

            <div class="col-lg-4 col-md-6 col-sm-6">
                <div class="contact-info-box">
                    <div class="icon">
                        <i class='flaticon-pin'></i>
                    </div>

                    <h3>Location Here</h3>
                    <p>Delta corner, Chiromo rd <br>Nairobi</p>
                </div>
            </div>

            <div class="col-lg-4 col-md-6 col-sm-6 offset-lg-0 offset-md-3 offset-sm-3">
                <div class="contact-info-box">
                    <div class="icon">
                        <i class='flaticon-phone-call'></i>
                    </div>

                    <h3>Call Here</h3>
                    <p><a href="tel:0722865048">0722865048</a></p>
                    <p><a href="tel: 0738247247"> 0738247247</a></p>
                </div>
            </div>
        </div>

        <div class="section-title">
            <span>Contact Us</span>
            <h2>Drop us Message for any Query</h2>
            <p>Fell free to talk to us at anytime anyday.</p>
        </div>

        <div class="contact-form">
            <form id="contactForm">
                {% csrf_token %}
                <div class="row">
                    <div class="col-lg-6 col-md-12">
                        <div class="form-group">
                            <input type="text" name="name" id="name" class="form-control" required
                                data-error="Please enter your name" placeholder="Name">
                            <div class="help-block with-errors"></div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-md-12">
                        <div class="form-group">
                            <input type="email" name="email" id="email" class="form-control" required
                                data-error="Please enter your email" placeholder="Email">
                            <div class="help-block with-errors"></div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-md-12">
                        <div class="form-group">
                            <input type="text" name="phone_number" id="phone_number" required
                                data-error="Please enter your number" class="form-control" placeholder="Phone">
                            <div class="help-block with-errors"></div>
                        </div>
                    </div>

                    <div class="col-lg-6 col-md-12">
                        <div class="form-group">
                            <input type="text" name="msg_subject" id="msg_subject" class="form-control" required
                                data-error="Please enter your subject" placeholder="Subject">
                            <div class="help-block with-errors"></div>
                        </div>
                    </div>

                    <div class="col-lg-12 col-md-12">
                        <div class="form-group">
                            <textarea name="message" class="form-control" id="message" cols="30" rows="5" required
                                data-error="Write your message" placeholder="Your Message"></textarea>
                            <div class="help-block with-errors"></div>
                        </div>
                    </div>

                    <div class="col-lg-12 col-md-12">
                        <button type="submit" class="default-btn">
                            Send Message
                            <span></span>
                        </button>
                        <div class="row col-md-4 offset-md-4">
                            <div id="msgSubmit" class="py-2">
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>
<!-- End Contact Area -->

{% endblock %}

{% block scripts %}
<script>

    $("#contactForm").on("submit", e => {
        e.preventDefault()
        postContact()
    })

    const postContact = () => {
        const loc = window.location
        const url = `${loc.protocol}//${loc.host}/api/contact/contact-form/messages/`
        const data = {
            name: $("#name").val(),
            email: $("#email").val(),
            phone_number: $("#phone_number").val(),
            subject: $("#msg_subject").val(),
            message: $("#message").val(),
        }

        toastr.options = {
            positionClass: "toast-bottom-center",
            progressBar: true,
            timeOut: 10000
        }
        const headers = {
            'X-CSRFToken': getCookie('csrftoken')
        }
        axios.post(url, data, { headers }).then((response) => {
            const data = response.data;
            toastr.info('Your Message has been sent. Thanks for getting in touch')
            $("#msgSubmit").html(`<div class="alert alert-success">Message sent successfully</div>`)
        }).catch((error) => {
            console.log(error)
            toastr.error(`Error - ${error.message}`)
            $("#msgSubmit").html(`<div class="alert alert-danger">${error.message}</div>`)
        });
    };

</script>
{% endblock %}