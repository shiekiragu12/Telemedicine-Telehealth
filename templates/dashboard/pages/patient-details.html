{% extends './../components/base.html' %}
{% load static %}


{% block content %}
<div class="content-body">
	<!-- row -->
	<div class="container-fluid">
		<div class="page-titles">
			<ol class="breadcrumb">
				<li class="breadcrumb-item active"><a href="javascript:void(0)">Patient information</a></li>
				<li class="breadcrumb-item"><a href="javascript:void(0)">{{patient.user.first_name}}
						{{patient.user.last_name}}</a></li>
			</ol>
		</div>

		<div class="row">
			<div class="col-xl-6 col-xxl-8">
				<div class="card">
					<div class="card-body">
						<div class="media d-sm-flex d-block text-center text-sm-start pb-4 mb-4 border-bottom">
							<img alt="image" class="rounded me-sm-4 me-0" width="130"
								src="{% if patient.user.profile.profile_photo %} {{patient.user.profile.profile_photo.url}} {% endif %}">
							<div class="media-body align-items-center">
								<div class="d-sm-flex d-block justify-content-between my-3 my-sm-0">
									<div>
										<h3 class="fs-22 text-black font-w600 mb-0 text-capitalize">
											{{patient.user.first_name}} {{patient.user.last_name}}</h3>
										<p class="mb-2 mb-sm-2">Check In date 21 Feb 2023, 12:45 AM</p>
									</div>
									<span>#P-00{{patient.id}}</span>
								</div>
								<a href="javascript:void(0);"
									class="btn bgl-primary btn-rounded text-black mb-2 me-2 text-capitalize">
									{{patient.user.profile.gender}}
								</a>
								<a href="javascript:void(0);" class="btn bgl-primary btn-rounded mb-2 text-black">
									<svg class="me-2 scale5" width="14" height="14" viewBox="0 0 28 28" fill="none"
										xmlns="http://www.w3.org/2000/svg">
										<path
											d="M27.75 11.5C27.7538 10.8116 27.568 10.1355 27.213 9.54575C26.8581 8.95597 26.3476 8.47527 25.7376 8.15632C25.1276 7.83737 24.4415 7.69248 23.7547 7.73752C23.0678 7.78257 22.4065 8.01581 21.8434 8.4117C21.2803 8.80758 20.837 9.35083 20.5621 9.98192C20.2872 10.613 20.1913 11.3076 20.2849 11.9896C20.3785 12.6715 20.6581 13.3146 21.0929 13.8482C21.5277 14.3819 22.101 14.7855 22.75 15.015V19C22.75 20.6576 22.0915 22.2473 20.9194 23.4194C19.7473 24.5915 18.1576 25.25 16.5 25.25C14.8424 25.25 13.2527 24.5915 12.0806 23.4194C10.9085 22.2473 10.25 20.6576 10.25 19V17.65C12.3301 17.3482 14.2323 16.3083 15.6092 14.7203C16.9861 13.1322 17.746 11.1019 17.75 9V1.5C17.75 1.16848 17.6183 0.850537 17.3839 0.616116C17.1495 0.381696 16.8315 0.25 16.5 0.25H12.75C12.4185 0.25 12.1005 0.381696 11.8661 0.616116C11.6317 0.850537 11.5 1.16848 11.5 1.5C11.5 1.83152 11.6317 2.14946 11.8661 2.38388C12.1005 2.6183 12.4185 2.75 12.75 2.75H15.25V9C15.25 10.6576 14.5915 12.2473 13.4194 13.4194C12.2473 14.5915 10.6576 15.25 9 15.25C7.34239 15.25 5.75268 14.5915 4.58058 13.4194C3.40848 12.2473 2.75 10.6576 2.75 9V2.75H5.25C5.58152 2.75 5.89946 2.6183 6.13388 2.38388C6.3683 2.14946 6.5 1.83152 6.5 1.5C6.5 1.16848 6.3683 0.850537 6.13388 0.616116C5.89946 0.381696 5.58152 0.25 5.25 0.25H1.5C1.16848 0.25 0.850537 0.381696 0.616116 0.616116C0.381696 0.850537 0.25 1.16848 0.25 1.5V9C0.25402 11.1019 1.01386 13.1322 2.3908 14.7203C3.76773 16.3083 5.6699 17.3482 7.75 17.65V19C7.75 21.3206 8.67187 23.5462 10.3128 25.1872C11.9538 26.8281 14.1794 27.75 16.5 27.75C18.8206 27.75 21.0462 26.8281 22.6872 25.1872C24.3281 23.5462 25.25 21.3206 25.25 19V15.015C25.9792 14.7599 26.6114 14.2848 27.0591 13.6552C27.5069 13.0256 27.7483 12.2726 27.75 11.5Z"
											fill="#2BC155"></path>
									</svg>
									{{patient.condition.name}}
								</a>
							</div>
						</div>

					</div>
				</div>
			</div>
			<div class="col-xl-3 col-xxl-4 col-md-6">
				
			</div>
		</div>

		<div class="card">
			<div class="card-header">
				<h3>Recent Appointments</h3>
			</div>
			<div class="card-body">
				<div class="table-responsiv">
					<table id="appointments" class="display" style="width:100%">
						<thead>
							<tr>
								<th>Doctor</th>
								<th>Note</th>
								<th>Condition</th>
								<th>Date</th>
								<th>Start Time</th>
								<th>End Time</th>
							</tr>
						</thead>
						<tbody>
							{% for appointment in patient.patient_appointments.all %}
							<tr>
								<td>Dr {{appointment.doctor.user.first_name}} {{appointment.doctor.user.last_name}}</td>
								<td>
									<button class="btn btn-primary px-4" data-bs-toggle="modal"
										data-bs-target="#info-modal"
										data-bs-title="{{appointment.patient.user.first_name}} {{appointment.patient.user.last_name}} - Appointment Note"
										data-bs-content="{{appointment.note}}">
										Read
									</button>
								</td>
								<td>{{appointment.condition.name}}</td>
								<td>{{appointment.date}}</td>
								<td>{{appointment.start_time}}</td>
								<td>{{appointment.end_time}}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<div class="card">
			<div class="card-header">
				<h3>Prescriptions</h3>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table id="prescriptions" class="display" style="width:100%">
						<thead>
							<tr>
								<th>Doctor</th>
								<th>Prescription</th>
								<th>Created On</th>
							</tr>
						</thead>
						<tbody>
							{% for prescription in patient.patient_prescriptions.all %}
							<tr>
								<td>Dr {{prescription.doctor.user.first_name}} {{prescription.doctor.user.last_name}}
								</td>
								<td>
									<button class="btn btn-primary px-4" data-bs-toggle="modal"
										data-bs-target="#info-modal"
										data-bs-title="{{prescription.patient.user.first_name}} {{prescription.patient.user.last_name}} - Prescription Note"
										data-bs-content="{{prescription.prescription}}">
										Read
									</button>
								</td>
								<td>{{prescription.created_on}}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>


		<div class="card">
			<div class="card-header">
				<h3>Medical Reports</h3>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table id="reports" class="display" style="width:100%">
						<thead>
							<tr>
								<th>Doctor</th>
								<th>Description</th>
								<th>Date</th>
							</tr>
						</thead>
						<tbody>
							{% for report in patient.patient_encounters.all %}
							<tr>
								<td>Dr {{report.doctor.user.first_name}} {{report.doctor.user.last_name}}</td>
								<td>
									<button class="btn btn-primary px-4" data-bs-toggle="modal"
										data-bs-target="#info-modal"
										data-bs-title="{{report.patient.user.first_name}} {{report.patient.user.last_name}} - Medical Report Note"
										data-bs-content="{{report.description}}">
										Read
									</button>
								</td>
								<td>{{report.date}}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
		</div>

	</div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'dashboard/vendor/datatables/js/jquery.dataTables.min.js' %}"></script>

<script>
	// $("span.donut").peity("donut", {
	// 	width: "180",
	// 	height: "180"
	// });
</script>


<script>
	$('#prescriptions').DataTable()
	$('#reports').DataTable()
	$('#appointments').DataTable()
</script>
{% endblock %}